using System;using System.Windows.Forms;
namespace Vault2Door{ public partial class Form1:Form{
private void AssetViewport_MouseWheel(object? s, MouseEventArgs e){ int d=-Math.Sign(e.Delta)*60; ScrollAssetsBy(d); }
private void ScrollTrackClick(int y){ int page=assetListPanel.Height-40; int top=assetScrollThumb.Top; if(y<top) ScrollAssetsBy(-page); else if(y>top+assetScrollThumb.Height) ScrollAssetsBy(page); }
private void MoveThumbTo(int newTop){ int min=0; int max=Math.Max(0, assetScrollTrack.Height-assetScrollThumb.Height); int clamp=Math.Max(min, Math.Min(max,newTop)); assetScrollThumb.Top=clamp; int range=Math.Max(0, assetContent.Height-assetListPanel.Height); if(range<=0){ assetScrollOffset=0; assetContent.Top=0; return;} float f=(float)clamp/Math.Max(1,max); assetScrollOffset=(int)(f*range); assetContent.Top=-assetScrollOffset; }
private void ScrollAssetsBy(int dy){ int range=Math.Max(0, assetContent.Height-assetListPanel.Height); int newOff=Math.Max(0, Math.Min(range, assetScrollOffset+dy)); assetScrollOffset=newOff; assetContent.Top=-assetScrollOffset; int max=Math.Max(0, assetScrollTrack.Height-assetScrollThumb.Height); float f= range==0?0: (float)newOff/range; assetScrollThumb.Top=(int)(f*max); }
private void UpdateAssetScrollMetrics(){ if(assetListPanel==null||assetScrollTrack==null||assetScrollThumb==null||assetContent==null) return; assetContent.Width=assetListPanel.Width-assetScrollTrack.Width; int range=Math.Max(0, assetContent.Height-assetListPanel.Height); if(range<=0){ assetScrollThumb.Visible=false; assetScrollOffset=0; assetContent.Top=0; } else{ assetScrollThumb.Visible=true; float ratio=(float)assetListPanel.Height/assetContent.Height; int thumbMin=24; int thumbSize=Math.Max(thumbMin, (int)(assetScrollTrack.Height*ratio)); assetScrollThumb.Height=Math.Min(thumbSize, assetScrollTrack.Height-4); ScrollAssetsBy(0); } }
} }